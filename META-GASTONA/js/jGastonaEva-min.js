/*
jGastonaEva-min.js version 0.202009 dbg2min
composed by Eva.js + EvaLayout.js + LayoutManager.js + httSaco.js + zWidgetsHtml.js + jGastona.js minified
is part of the open source project https://github.com/wakeupthecat/gastona

Copyright (C) 2015-2020 Alejandro Xalabarder Aulet
@license : GNU General Public License (GPL) version 3 + comercial license through OpenSoftwareCongoFee

This program is distributed in the hope that it will be useful, but WITHOUT ANY
WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
PARTICULAR PURPOSE. See the GNU General Public License for more details.
*/
function evaFileObj(c){if(typeof c==="string"){c=evaFileStr2obj(c)}return{obj:c,toText:function(){return d(c)},toString:function(){return d(c)},evaFileObj2Text:d,evaUnitObj2Text:b,evaObj2Text:a};function d(e){var g=[];for(var f in e){if(e.hasOwnProperty(f)){g.push("#"+f+"#");g.push("");g.push(b(e[f]));g.push("")}}return g.join("\n")}function b(e){var g=[];for(var f in e){if(e.hasOwnProperty(f)){g.push("");g.push("   <"+f+">");g.push("");g.push(a(e[f]))}}return g.join("\n")}function a(g){var i=[],f="";for(var h in g){if(g.hasOwnProperty(h)){f="      ";for(var e=0;e<g[h].length;e++){if(e>0){f+=", "}if(e==g[h].length-1){f+="//"}f+=g[h][e]}i.push(f)}}return i.join("\n")}}function evaFile(a){alert("evaFile function name is deprecated! please use evaFileStr2obj instead");evaFileStr2obj(a)}function evaFileUTF82obj(a){return evaFileStr2obj(decodeURIComponent(a.replace(/\+/g,"%20")))}function evaFileStr2obj(f){function e(g){return g.replace(/^\s+|\s+$/g,"")}function b(g){return g.replace(/\r\n/g,"\r").replace(/\n/g,"\r").split(/\r/)}return c(f);function d(g,h,j){if(g.charAt(0)!==h){return}var i=g.indexOf(j,1);if(i>0){return{name:g.substr(1,i-1),rest:e(g.substr(i+1))}}}function a(l){var g=[];var j=l.length;var k=0;function m(){return k>=l.length}function h(){var n="";while(k<l.length&&(l.charAt(k)==" "||l.charAt(k)=="\t")){k++}if(m()){return null}if(l.charAt(k)=="'"){n=l.substring(k+1);k=j;return n}if(l.charAt(k)=="/"&&l.charAt(k+1)=="/"){n=l.substring(k+2);k=j;return n}var p=l.charAt(k)=='"';var o=p?++k:k;do{if(p){if(l.charAt(k)!='"'){k++}else{if(l.charAt(k+1)=='"'){n+=(k+1>o?l.substring(o,k+1):"");k+=2;o=k}else{break}}}else{if(l.charAt(k)==","){break}k++}}while(!m());var q=k;if(!p){while(q>o&&(l.charAt(q-1)===" "||l.charAt(q-1)==="\t")){q--}}if(q>o){n+=l.substring(o,q)}k++;if(p){while(!m()&&l.charAt(k)!=","){k++}k++}return n}do{var i=h();if(typeof i==="string"){g.push(i)}}while(!m());return g}function c(q){var n,i;var l={},r={},o=[];function j(s){if(i){r[i]=o.length>0?o:[[""]]}i=undefined;o=[];if(s){if(n){l[n]=r}n=undefined;r=[]}}var p=q;if(typeof q==="string"){p=b(q)}for(var h=0;h<p.length;h++){var g=e(p[h]);if(g.charAt(0)==="<"&&g.charAt(1)==="!"){continue}var k=d(g,"#","#");if(k){if(k.name&&k.name.charAt(0)==="*"&&k.name.charAt(1)=="*"){break}j(true);n=k.name;continue}k=d(g,"<",">");if(k){j(false);i=k.name;g=k.rest;if(g.length==0){continue}}if(g&&n&&i){var m=a(g);if(m){o.push(m)}}else{}}j(true);return l}}function EvaLayout(b,q){var p=0;var r="A";var a="X";var u="-";var c="+";var k,m,o=false;var n=b.guiLayouts[q];var g={left:0,right:200,top:0,bottom:20};var h={ileft:0,iright:0,itop:0,ibottom:0};if(!n){console.log('ERROR: no eva found with name "'+q+'"');return}if(!n[0][0].match(/^eva$|^evalayout$/i)){return}return{precalculateLayout:j,wName:q,isLaidOut:false,iniRect:g,indxPos:h,invalidate:function(){o=false},isWidget:false,doMove:l,doShow:t};function i(z,F){var x=0,w=1,C=2,E=0,I=0,y=[];return{margin:z,gap:F,fixedSize:function(){return I},regla:y,addItem:H,setLengthOfItemAt:G,endItems:D,getLengthInRange:A,countItems:function(){return y.length}};function B(K){var L=w,M=0,J=0;K=K+"";if(K.length==0||K.indexOf(r)==0){L=w}else{if(K.indexOf(a)==0){L=C;M=(K.length<2)?1:parseInt(K.substr(1))}else{L=x;J=parseInt(K)}}return{type:L,len:J,extraPercent:M}}function H(J){var K=B(J||"");y.push(K);E+=K.extraPercent}function G(K,J){if(y[K]&&y[K].type==w){y[K].len=Math.max(y[K].len,J)}}function D(){var J,K;I=z+z+F*(y.length-1);for(J in y){if(y.hasOwnProperty(J)){K=y[J];I+=K.len;if(E>0){K.extraPercent=(K.extraPercent/E)}}}}function A(M,K,L){var J=0;L=L||K;for(;(K<=L||L==-1)&&K<y.length;K++){J+=F+y[K].len+y[K].extraPercent*M}return J}}function s(w){return n[1][w+1]}function d(w){return n[2+w][0]}function e(){return n.length-2}function f(w){return n[2+w].length-1}function v(w,x){w+=2;x+=1;if(w>=0&&w<n.length&&x>=0&&x<n[w].length){return n[w][x]}}function j(){if(o){return}k=i(parseInt(n[0][1])||0,parseInt(n[0][3])||0);m=i(parseInt(n[0][2])||0,parseInt(n[0][4])||0);var B=0;var A=e();for(var y=0;y<A;y++){B=f(y);m.addItem(d(y));for(var C=0;C<B;C++){if(C>=k.countItems()){k.addItem(s(C))}var w=v(y,C);if(!w){continue}if(p){console.log("precalc "+w)}var z=b.getLayableByName(w);if(!z){continue}z.indxPos.ileft=C;z.indxPos.itop=y;var x=C;while(x+1<B&&v(y,x+1)===u){x++}if(x+1<B&&v(y,x+1)===u+u){x=-1}z.indxPos.iright=x;if(x==C){k.setLengthOfItemAt(C,z.iniRect.right-z.iniRect.left)}x=y;while(x+1<A&&v(x+1,C)===c){x++}if(x+1<A&&v(x+1,C)===c+c){x=-1}z.indxPos.ibottom=x;if(x==y){m.setLengthOfItemAt(y,z.iniRect.bottom-z.iniRect.top)}if(p){console.log("precalc set "+w+" at "+z.indxPos.ileft+", "+z.indxPos.itop+", "+z.indxPos.iright+", "+z.indxPos.ibottom)}z.isLaidOut=true}}k.endItems();m.endItems();g.top=0;g.bottom=m.fixedSize();g.left=0;g.right=k.fixedSize();o=true}function l(y,G,H,A){j();var B=Math.max(0,A-m.fixedSize());var D=Math.max(0,H-k.fixedSize());var x=y+k.margin;for(var z=0;z<k.countItems();z++){if(z>0){x+=k.getLengthInRange(D,z-1)}var w=G+m.margin;for(var C=0;C<m.countItems();C++){if(C>0){w+=m.getLengthInRange(B,C-1)}var F=v(C,z);if(!F){continue}var E=b.getLayableByName(F);if(!E){continue}if(E.isLaidOut){var J=-k.gap;var I=-m.gap;J+=k.getLengthInRange(D,E.indxPos.ileft,E.indxPos.iright);I+=m.getLengthInRange(B,E.indxPos.itop,E.indxPos.ibottom);if(x<0||w<0||J<0||I<0){if(p){console.log("esto "+F+" no se ve na de na "+x+", "+w+", "+J+", "+I)}continue}if(p){console.log("widget "+F+" set at "+x+", "+w+" dim "+J+" x "+I)}E.doMove(x,w,J,I);E.doShow(true)}else{if(p){console.log("esto "+F+" lo oculto ")}E.doShow(false)}}}}function t(x){j();for(var z=0;z<k.countItems();z++){for(var w=0;w<m.countItems();w++){var y=b.getLayableByName(v(w,z));if(y){y.doShow(x)}}}}}function layoutManager(j,q){var e,m,v,l={},u=[],t={},p=[],i;a(j);return{guiConfig:m,loadConfig:function(w){j=w;a(j)},maskLayoutId:b,unmaskLayoutId:r,doShowLayout:function(w,y,x){c(w,0,0,y,x)},setLayout:function(w){g(w)},doLayout:function(x,w){c(i,0,0,x,w)}};function h(w,y,x){for(x in w){if(w[x]===y){console.log("ERROR: layout element "+y+" already exists, it cannot be stacked!");return false}}return true}function g(w){if(!i||i!==w){n()}i=w}function n(){for(var x in t){var w=t[x];if(!w.isWidget){w.invalidate()}else{w.doShow(false)}}}function d(w,x){x=q.defaultSize4widget(w,x);return{wName:w,isLaidOut:false,iniRect:x||{left:0,right:200,top:0,bottom:20},indxPos:{ileft:0,iright:0,itop:0,ibottom:0},isWidget:true,doMove:function(z,C,B,A){q.doMoveWidget(w,z,C,B,A)},doShow:function(y){q.doShowWidget(w,y)}}}function k(x){if(x===""||!s(x)){return}var w=t[o(x)];if(!w){console.log("ERROR: don't know how to find "+x+" or "+o(x));return d("bDummy")}if(h(u,w.wName)){if(!w.isWidget){w.precalculateLayout()}}return w}function b(w,z,y){var x=z;if(y!==undefined&&l[w]&&l[w]==z){x=y}l[w]=(!x||x===""||w===x)?undefined:x;v=true;n()}function r(w){if(!l[w]){return false}l[w]=undefined;v=true;n();return true}function o(y){var z,x,w=[];if(!s(y)){return y}do{z=l[y];if(!z||z===""||z===y){return y}for(x in w){if(w[x]===z){console.log("ERROR: masks for "+y+" found circular!");return y}}w.push(y);y=z}while(w.length<200);console.log("ERROR: masks for "+y+" too deep!");return y}function s(w){if(!w||w.length==0){return false}return w.match(/^[^+-]/)}function f(){return{guiLayouts:e,guiConfig:m,getLayableByName:k}}function a(z){m={};e=z.layouts;if(!e){e={};var C=z.jGuix||z.guix||z.javaj;if(!C){console.log("Error: unit layouts not found!");return}for(var B in C){if(B.indexOf("layout of ")==0){e[B.substr(10)]=C[B]}else{m[B]=C[B]}}}v=true;l={};u=[];t={};for(var y in e){var w=EvaLayout(f(),y);if(w){t[y]=w}}for(var y in e){var B=e[y];for(var x=2;x<B.length;x++){for(var D=1;D<B[x].length;D++){var A=B[x][D];if(s(A)){if(!t[A]){q.addWidget(A);t[A]=d(A)}}}}}}function c(B,z,A,y,x){B=B||"main";g(B);var w=k(B);if(w){u.push(w.wName);w.doMove(z,A,y,x);u.pop()}}}function httPack(k,f){var a={onelineparams:"",headers:{},body:""};var j={};var g="";var e=[];var i=true;if(typeof k==="string"){e=[k]}else{k=k||{};i=k.encodeUTF8!==false;a.headers=k.headers||{};var h=k.params||k.parameters||{};if(typeof h==="string"){e=[h]}else{for(var c in h){e.push(c+"="+b(h[c]))}}g=k.body;if(typeof g!=="string"){g=d(k.bodyVars,k.bodyVarsFormat||"eva")}}a.onelineparams=e.join("&");a.body=g;return a;function b(l){return i?encodeURIComponent((""+l).replace(/'/g,"%27")):l+""}function d(m,r){function l(z){if(!i){return f[m[z]]}var B=[];var A=f[m[z]];for(var x in A){var w=[];for(var y in A[x]){w.push(b(A[x][y]))}B.push(w)}return B}function q(x){function w(A){var C=[],z;for(var B in A){for(var y in A[B]){C.push((y>0)?",":""+A[B][y])}}return C.join("\n")}return b(w(f[m[x]]))}if(!m){m=[];for(var v in f){m.push(v)}}var s;var o="";if(r==="propval"){var p=[];for(s in m){p.push(m[s]+":"+q(s))}o=p.join("\n")}else{if(r==="json"){var n={};for(s in m){n[m[s]]=l(s)}o=JSON.stringify(n)}else{if(r==="eva"){var u=evaFileObj("#data#\n");var t=u.obj.data;for(s in m){t[m[s]]=l(s)}o=u.toText()}else{alert("ERROR: calling formatBody with not supported format ["+r+"]")}}}return o}}function httUnpack(h,d){var b={};var k={};var i=d.getResponseHeader("Content-Type");if(i){k=null;g=i.split(";");if(g.indexOf("text/eva")!==-1){k=evaFileStr2obj(h)}else{if(g.indexOf("text/evas")!==-1){k=evaFileStr2obj("#anonima#\n"+h)["anonima"]}else{if(g.indexOf("text/json")!==-1){k=JSON.parse(h)}}}}if(k==null){k={rawBody:h}}b["obj-body"]=k;i=d.getResponseHeader("XParamsInOneLine");if(i){k={};var g=i.split("&");for(var j in g){var f=g[j].split("=");if(f.length===2){k[f[0]]=decodeURIComponent(f[1])}else{console.log("ERROR on XParamsInOneLine variable ["+g[j]+"]")}}b["obj-params"]=k}k={};var c=d.getAllResponseHeaders().split("\n");for(var e in c){var a=c[e].split(":",1);if(a&&a[0]){k[a[0]]=d.getResponseHeader(a[0])}}b["obj-headers"]=k;return b}function zWidgets(htmlStamm,laData,mensaka){var javajzWidgets={};return{addWidget:addWidget,deliverMsgToWidget:deliverMsgToWidget,defaultSize4widget:defaultSize4widget,doMoveWidget:doMoveWidget,doShowWidget:doShowWidget};function str2lineArray(str){return str.replace(/\r\n/g,"\r").replace(/\n/g,"\r").split(/\r/)}function getIdValue(id){var ele=document.getElementById(id);return(ele)?ele.value:getDataCell(id)}function getWidgetByName(widName){return javajzWidgets[widName]}function getzWidgetByName(nam){return getWidgetByName(nam)}function deliverMsgToWidget(wname,msg){var zwidget=getWidgetByName(wname);if(!zwidget){return false}if(zwidget[msg]){zwidget[msg]();return true}alert("ERROR (updateWidget) zwidget /"+zwidget.id+"/ with no 'data!' message");return false}function defaultSize4widget(wname,oRect){if(!oRect){var ele=document.getElementById(wname);if(ele){var height=(ele.offsetHeight+1);var width=(ele.offsetWidth+1);if(height>1){oRect={left:0,right:width*1.2,top:0,bottom:height*1.2}}}}return oRect}function doMoveWidget(wname,x,y,dx,dy){var ele=document.getElementById(wname);if(ele){ele.style.position="absolute";ele.style.left=Math.round(x)+"px";ele.style.top=Math.round(y)+"px";ele.style.width=Math.round(dx)+"px";ele.style.height=Math.round(dy)+"px"}else{console.log("ERROR expected html element "+wname+" not found!")}}function doShowWidget(wname,bShow){var elm=document.getElementById(wname);if(elm){elm.style.visibility=bShow?"visible":"hidden"}}function strStartsWith(s1,s2,pos){pos=pos||0;return s1.indexOf(s2,pos)===pos}function setValueToElement(element,valueStr){if(element){if(typeof element.value==="string"){element.value=valueStr}else{element.innerHTML=valueStr}}}function addWidget(name){if(!name||name.length==0){return}var zwid;function var2Text(name){if(name.length<=2){return""}var sal=name[1];for(var ii=2;ii<name.length;ii++){if(name[ii]=="_"){sal+=" "}else{if(name[ii]<"Z"&&sal[sal.length-1]!=" "){sal+=" "}sal+=name[ii]}}return sal}var updateSimpleLabel=function(){this.innerHTML=(laData.dataUnit[name]?laData.getDataCell(name):var2Text(name))};var updateSimpleLabel2=function(){this.innerHTML=(laData.dataUnit[name]?laData.getDataCell(name):var2Text(name.substr(1)))};var updateSimpleValue=function(){setValueToElement(this,laData.getDataCell(name))};var updateSimpleSrc=function(){this.src=laData.getDataCell(name)};var updateResetValue=function(){this.value=""};var updateImage=function(){this["style"]["background-image"]="url('"+laData.getDataCell(name)+"')"};var signalName=function(){mensaka(name)};var assignValue=function(){laData.dataUnit[name][0]=[this.value||"?"];signalName()};var assignText=function(){laData.dataUnit[name]=[[]];var text=this.value||"?";var rows=str2lineArray(text);for(var rr in rows){laData.dataUnit[name][rr]=[rows[rr]]}signalName()};var hayTagOf=laData.dataUnit["htmltag of "+name];if(hayTagOf){zwid=fabricaStandard(hayTagOf,name,{"data!":updateSimpleSrc})}else{var hayClassOf=laData.dataUnit["class of "+name];var widgetclass=hayClassOf?hayClassOf[0][0]:name;switch(widgetclass.charAt(0)){case"d":zwid=fabricaStandard("div",name,{"data!":updateSimpleLabel});break;case"n":zwid=fabricaStandard("a",name,{href:"login","data!":updateSimpleLabel});break;case"b":zwid=fabricaStandard("button",name,{onclick:signalName,"data!":updateSimpleLabel});break;case"e":zwid=fabricaStandard("input",name,{type:"text",onchange:assignValue,placeholder:var2Text(name),"data!":updateSimpleValue});break;case"u":zwid=fabricaStandard("input",name,{type:"file",onchange:signalName,"data!":updateResetValue});break;case"m":zwid=fabricaStandard("div",name,{onclick:signalName,"data!":updateImage});zwid.style["background-position"]="center center";zwid.style["background-repeat"]="no-repeat";zwid.style["background-size"]="contain";break;case"p":zwid=fabricaStandard("input",name,{type:"password",placeholder:"password",onchange:assignValue,"data!":updateSimpleValue});break;case"h":if(widgetclass.length>=2){zwid=fabricaStandard("h"+widgetclass.charAt(1),name,{"data!":updateSimpleLabel2})}break;case"l":zwid=fabricaStandard("label",name,{"data!":updateSimpleLabel});break;case"x":var updata=function(){var tex="",row;if(!laData.isEvaEmpty(laData.dataUnit[this.id])){for(row in laData.dataUnit[this.id]){tex+=laData.dataUnit[this.id][row]+"\n"}}setValueToElement(this,tex)};zwid=fabricaStandard("textarea",name,{placeholder:var2Text(name),"data!":updata,onchange:assignText});break;case"t":var updata=function(){var etabla,rowele,colele,row,col,evaData=laData.dataUnit[this.id];while(this.hasChildNodes()){this.removeChild(this.firstChild)}etabla=document.createElement("table");etabla.id=this.id+"-table";for(row in evaData){if(laData.isEvaEmpty(evaData)){}else{rowele=document.createElement("tr");for(col in evaData[row]){colele=document.createElement(row==="0"?"th":"td");setValueToElement(colele,evaData[row][col]);rowele.appendChild(colele)}etabla.appendChild(rowele)}}this.appendChild(etabla)};zwid=fabricaSimpleTable(name,{"data!":updata});break;case"c":case"r":case"k":case"i":zwid=fabricaLista(name);htmlStamm.appendChild(zwid);break}}if(zwid){javajzWidgets[name]=zwid;htmlStamm.appendChild(zwid);deliverMsgToWidget(name,"data!");if(!laData.dataUnit[name]){laData.dataUnit[name]=[[""]]}}}function str2Var(str){var str2="";if(typeof str!=="string"){str2=str.join("\n")}else{str2=str}if(str2.match(/^\s*[\"\']/)){return str2.substr(1)}if(str2.match(/^\s*[\[\{]/)){return eval("(function () { return "+str2+";}) ()")}return str2}function fabricaStandard(typestr,name,atts){var ele=document.createElement(typestr);ele.id=name;ele.style.visibility="hidden";ele.spellcheck=false;for(var aa in atts){ele[aa]=atts[aa]}if(typestr==="input"&&!laData.dataUnit[name]){laData.dataUnit[name]=[[""]]}for(var dd in laData.dataUnit){if(strStartsWith(dd,name+" ")){var attrib=dd.substr(name.length+1);var value=laData.dataUnit[dd];if(strStartsWith(attrib,"on")){ele.addEventListener(attrib.substr(2),function(){if(attrib!=="onchange"&&ele.onchange){ele.onchange()}eval(str2Var(value))})}else{if(attrib=="class"){ele.className=value}else{if(attrib=="+class"){ele.className+=(" "+value)}}}try{ele[attrib]=str2Var(value)}catch(err){}}}return ele}function fabricaLista(name){var orient=laData.dataUnit[name+" orientation"]||"X";if(name.charAt(0)=="c"){return fabricaSelectList(name,false)}if(name.charAt(0)=="i"){return fabricaSelectList(name,true)}if(name.charAt(0)=="r"){return fabricaGrupo(name,"radio",false)}if(name.charAt(0)=="k"){return fabricaGrupo(name,"checkbox",true)}}function selectAllColumnsFromTable(unit,name,val){if(!unit||!unit[name]||!unit[name][0]){return false}var colnames=unit[name][0];var indxVal=colnames.indexOf("value");if(indxVal===-1){indxVal=0}for(var col in colnames){delete unit[name+" selected."+colnames[col]]}for(var rosel=1;rosel<unit[name].length;rosel++){if(unit[name][rosel][indxVal]===val){for(var col in colnames){unit[name+" selected."+colnames[col]]=[[unit[name][rosel][col]||"?"]]}return true}}return false}function whenChangeTableSelection(name,este,value){if(este["selectionType uid.checked"]){if(este.uid){laData.dataUnit[name+" "+este.uid+".checked"]=[[este.checked?"1":"0"]]}}else{if(selectAllColumnsFromTable(laData.dataUnit,name,value||"")){laData.dataUnit[name+"_value"]=[[value||"?"]];laData.dataUnit[name+"_uid"]=[[este.uid]]}else{delete laData.dataUnit[name+"_value"];delete laData.dataUnit[name+"_uid"]}}mensaka(name)}function table2ColumnObj(tata){var obj={};if(!tata||!tata[0]){return obj}var cols=tata[0];for(var ii in cols){var colname=cols[ii];obj[colname]=[];for(var rr=1;rr<tata.length;rr++){obj[colname].push(tata[rr][ii])}}return obj}function addCommonAttributesToCheckableItem(item,indx,name,label,tableTrans,uidchecked,selectedcolumn){var valuecol=getColName(name,"value");item.name=name;item.value=valuecol?tableTrans[valuecol][indx]:"?";item.label=label;item.uid=(tableTrans.uid?tableTrans.uid[indx]||indx:indx);item.checked=(tableTrans.selected?tableTrans.selected[indx]||"0":"0")==="1";item["data!"]=function(){}}function getColName(unitname,colname){if(!laData.dataUnit[unitname]||!laData.dataUnit[unitname][0]||laData.dataUnit[unitname][0].length<1){console.log("ERROR: No column can be used as label in list "+unitname+"!");return null}var indxLabel=laData.dataUnit[unitname][0].indexOf(colname);if(indxLabel==-1){indxLabel=0}return laData.dataUnit[unitname][0][indxLabel]}function fabricaSelectList(name,multipleSelection){var ele=document.createElement("select");ele.multiple=multipleSelection;ele.id=name;ele.style.visibility="hidden";ele.addEventListener("change",function(){whenChangeTableSelection(name,this,this.value)});ele["data!"]=function(){while(this.hasChildNodes()){this.removeChild(this.firstChild)}var tableTrans=table2ColumnObj(laData.dataUnit[name]);var labelcol=getColName(name,"label");if(!labelcol){return}var labels=tableTrans[labelcol];for(var ii in labels){var subele=document.createElement("option");addCommonAttributesToCheckableItem(subele,ii,name,labels[ii],tableTrans);subele.appendChild(document.createTextNode(labels[ii]));this.appendChild(subele)}};return ele}function fabricaGrupo(name,tipo,multipleSelect){var ele=document.createElement("div");ele.id=name;ele.style.visibility="hidden";ele["data!"]=function(){var orient=laData.dataUnit[name+" orientation"]||"X";var tableTrans=table2ColumnObj(laData.dataUnit[name]);while(this.hasChildNodes()){this.removeChild(this.firstChild)}var labelcol=getColName(name,"label");if(!labelcol){}var labels=tableTrans[labelcol];var widthEstim=0;for(var ii in labels){var subelem=document.createElement("input");subelem.type=tipo;addCommonAttributesToCheckableItem(subelem,ii,name,labels[ii],tableTrans);subelem["selectionType uid.checked"]=multipleSelect;if(subelem["selectionType uid.checked"]){laData.dataUnit[name+" "+subelem.uid+".checked"]=[[subelem.checked?"1":"0"]]}var estimW=12*labels[ii].length;subelem["data!"]=function(){};subelem.addEventListener("change",function(){whenChangeTableSelection(name,this,this.value)});if(orient=="Y"||orient=="V"){this.appendChild(document.createElement("br"));widthEstim=Math.max(widthEstim,estimW)}else{widthEstim+=estimW}this.appendChild(subelem);this.appendChild(document.createTextNode(labels[ii]))}this.style.width=widthEstim+"px"};return ele}function fabricaSimpleTable(name,atts){var ele=document.createElement("div");ele.id=name;ele.widgetype="t";ele.style.visibility="hidden";for(var aa in atts){ele[aa]=atts[aa]}return ele}}function jGastona(evaConfig,existingPlaceId){var laData=dataStruct();var listixUnit={};var corpiny;var isStammLayout=false;var layMan;var losWidgets;var getData=function(name){return laData.getData(name)};var getDataAsTextArray=function(name){return laData.getDataAsTextArray(name)};var getDataCell=function(name,row,col){return laData.getDataCell(name,row,col)};var setData=function(name,value){return laData.setData(name,value)};var setDataCell=function(name,value,row,col){return laData.setDataCell(name,value,row,col)};var setVarTable_DimVal=function(arrVarNames){return laData.setVarTable_DimVal(arrVarNames)};var getCellEvaUnit=function(unit,eva,row,col){return laData.getCellEvaUnit(unit,eva,row,col)};var AJAX_RESPONSE_MESSAGE="ajaxResponse";var started=false;function start(){started=true;loadJast(evaConfig,existingPlaceId);window.addEventListener("resize",adaptaLayout)}function dataStruct(unit){var dataUnit=unit||{};return{dataUnit:dataUnit,getCellEvaUnit:getCellEvaUnit,getData:getData,getDataAsTextArray:getDataAsTextArray,getDataCell:getDataCell,setData:setData,setDataCell:setDataCell,setVarTable_DimVal:setVarTable_DimVal,isEvaValue:isEvaValue,isEvaSingleValue:isEvaSingleValue,isEvaEmpty:isEvaEmpty};function isEvaValue(eva){return Array.isArray(eva)&&eva.length>0&&Array.isArray(eva[0])}function isEvaSingleValue(eva){return isEvaValue(eva)&&eva.length==1&&eva[0].length==1}function isEvaEmpty(eva){return isEvaSingleValue(eva)&&eva[0][0]===""}function getCellEvaUnit(unit,eva,row,col){return unit[eva]?unit[eva][row||"0"][col||"0"]||"":""}function getData(name){return !dataUnit[name]?undefined:dataUnit[name]}function getDataAsTextArray(name){var eva=getData(name);var sal=[];for(var ii in eva){sal.push(eva[ii][0])}return sal}function getDataCell(name,row,col){return getCellEvaUnit(dataUnit,name,row,col)}function setDataCell(name,value,row,col){row=row||"0";col=col||"0";if(!dataUnit[name]){dataUnit[name]=[[""]]}if(!dataUnit[name][row]){dataUnit[name][row]=[""]}dataUnit[name][row][col]=value||""}function setData(name,value){if(typeof value==="string"||typeof value==="number"){dataUnit[name]=[[""]];setDataCell(name,value+"")}else{if(isEvaValue(value)){dataUnit[name]=value}else{alert('Error: setData "'+name+'", the value is not a string nor looks like an eva variable')}}mensaka(name+" data!")}function setVarTable_DimVal(arrVarNames){var vara=[["dimension","value"]];for(var fi in arrVarNames){vara.push([arrVarNames[fi],getDataCell(arrVarNames[fi])])}dataUnit.varTable_DimVal=vara}}return{start:start,run:start,getLayoutMan:function(){return layMan},mensaka:mensaka,getData:getData,getDataAsTextArray:getDataAsTextArray,getDataCell:getDataCell,setData:setData,setDataCell:setDataCell,setVarTable_DimVal:setVarTable_DimVal,getCellEvaUnit:getCellEvaUnit,adapta:adaptaLayout,mask:mask,unmask:unmask,canUploadFile:canUploadFile,laData:laData,AJAXAnyMethodRaw:AJAXAnyMethodRaw,AJAXPostRaw:AJAXPostRaw,AJAXSend:AJAXSend,AJAXUploadFile:AJAXUploadFile,AJAXLoadRootJast:AJAXLoadRootJast,AJAXgetDataForId:AJAXgetDataForId,AJAXGetDataForId:AJAXgetDataForId,AJAXLoadData:AJAXLoadData};function str2lineArray(str){return str.replace(/\r\n/g,"\r").replace(/\n/g,"\r").split(/\r/)}function getWindowWidth(){return isStammLayout?(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)-15:corpiny.offsetWidth}function getWindowHeight(){return isStammLayout?(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)-15:corpiny.offsetHeight}function mask(a,b,c){if(layMan){layMan.maskLayoutId(a,b,c);adaptaLayout()}}function unmask(a){if(layMan&&layMan.unmaskLayoutId(a)){adaptaLayout();return true}return false}function adaptaLayout(){if(!layMan){return}var dx=getWindowWidth();var dy=getWindowHeight();var lali=layMan.guiConfig.layoutWindowLimits;if(lali&&lali[0]){var mindx=parseInt(lali[0][0]||"0");var mindy=parseInt(lali[0][1]||"0");var maxdx=parseInt(lali[0][2]||"0");var maxdy=parseInt(lali[0][3]||"0");dx=Math.max(dx,mindx);dy=Math.max(dy,mindy);if(maxdx>0){dx=Math.min(dx,maxdx)}if(maxdy>0){dy=Math.min(dy,maxdy)}}if(layMan){layMan.doLayout(dx,dy)}}function loadJast(evaConfig,placeId){laData=dataStruct();listixUnit={};layMan=undefined;if(!evaConfig){return}laData=dataStruct(evaConfig.data);listixUnit=evaConfig.jListix||evaConfig.jlistix||evaConfig.listix||{};if(!corpiny){var baseId=placeId||"jGastonaStammHtmlElem";if(!document.getElementById(baseId)){document.body.innerHTML="<div id='"+baseId+"' style = 'position:relative;'></div>";isStammLayout=true}corpiny=document.getElementById(baseId)}if(!corpiny){console.error("no baseId can be found!");return}while(corpiny.hasChildNodes()){corpiny.removeChild(corpiny.firstChild)}losWidgets=zWidgets(corpiny,laData,mensaka);layMan=layoutManager(evaConfig,losWidgets);adaptaLayout();var fmain=listixUnit.main;if(fmain){executeListixFormat(fmain)}}function mensaka(msg){var ii=msg.indexOf(" ");if(ii>0){var wnam=msg.substr(0,ii);var wmet=msg.substr(ii+1);if(losWidgets){losWidgets.deliverMsgToWidget(wnam,wmet)}}var fbody=laData.dataUnit["-- "+msg]||listixUnit["-- "+msg]||null;if(!fbody){return}executeListixFormat(fbody)}function executeListixFormat(fbody){eval(fbody.join("\n"))}function updatezWidget(zwidget){mensaka(zwidget+" data!")}function jaxGetHttpReq(){if(window.XMLHttpRequest){return new XMLHttpRequest()}else{if(window.ActiveXObject){return new ActiveXObject("Microsoft.XMLHTTP")}}alert("Your browser does not support AJAX!")}function ajaxGenericPreProcessResponse(httresp){}function AJAXAnyMethodRaw(method,sendStr,bodyStr,objHeader,respFuncOrObj){var httpero=jaxGetHttpReq();if(!httpero){return false}var postTitle=sendStr.substring(0,sendStr.indexOf("?"));if(postTitle.length==0){postTitle=sendStr}httpero.onreadystatechange=function(){if(httpero.readyState==4&&httpero.status==200){ajaxGenericPreProcessResponse(httpero);if(typeof respFuncOrObj==="function"){respFuncOrObj(httpero.responseText,httpero)}else{if(typeof respFuncOrObj=="object"){Object.assign(respFuncOrObj,httUnpack(httpero.responseText,httpero))}}mensaka(AJAX_RESPONSE_MESSAGE+" "+postTitle)}};httpero.open(method,sendStr,true);if(objHeader){for(var indx in objHeader){httpero.setRequestHeader(indx,objHeader[indx])}}httpero.send(bodyStr||"")}function AJAXPostRaw(sendStr,bodyStr,objPOSTHeader,respFuncOrObj){return AJAXAnyMethodRaw("POST",sendStr,bodyStr,objPOSTHeader,respFuncOrObj)}function AJAXSend(postString,paramCfg,respFuncOrObj){var poso=httPack(paramCfg,laData.dataUnit);AJAXPostRaw(postString+"?"+poso.onelineparams,poso.body,poso.headers,respFuncOrObj)}function htmlElem(elmeOrId){if(typeof elmeOrId==="string"){return document.getElementById(elmeOrId)}return elmeOrId}function canUploadFile(widname,maxSizeMB,alertEmpty,alertTooBig){var ele=htmlElem(widname);var fileEle=ele.files[0];var sizeLimitMB=maxSizeMB;if(!fileEle||fileEle===""){if(alertEmpty!==""){alert(alertEmpty?alertEmpty:"Please first choose a file!")}return false}if(sizeLimitMB&&sizeLimitMB>0&&fileEle.size>sizeLimitMB*1024*1024){if(alertTooBig!==""){alert(alertTooBig?alertTooBig:("File is too big to be uploaded, limit is "+maxSizeMB+" MB"))}return false}return true}function AJAXUploadFile(fileElement,postMsg,postHeaders,respFuncOrObj){if(!fileElement){return false}var fileEle=htmlElem(fileElement);var file1=fileEle.files[0];if(!file1||file1===""){return false}var formo=new FormData();formo.append("filename",file1);AJAXPostRaw(postMsg+"?fileName="+file1,formo,postHeaders,respFuncOrObj);return true}function AJAXLoadData(loadIdentifier,paramCfg){var poso=httPack(paramCfg,laData.dataUnit);AJAXPostRaw("loadData?loadIdentifier="+(loadIdentifier||"")+"&"+poso.onelineparams,poso.body,poso.headers,function(bodytxt,httpero){var subobj=evaFileStr2obj(bodytxt)["data"];if(subobj){for(var vara in subobj){setData(vara,subobj[vara])}}})}function AJAXLoadRootJast(jastName,placeId){AJAXPostRaw("loadRootJast?jastName="+jastName||"","",null,function(txt){loadJast(evaFileStr2obj(txt),placeId)})}function AJAXgetDataForId(idname,paramCfg,multiple,onlyhtml){var poso=httPack(paramCfg,laData.dataUnit);AJAXPostRaw("getDataForId?id="+idname+"&"+poso.onelineparams,poso.body,poso.headers,function(txt){setContentsFromBody(idname,txt,multiple,onlyhtml);mensaka(AJAX_RESPONSE_MESSAGE+" getDataForId "+idname)})}function setValueToElement(element,valueStr){if(element){if(typeof element.value==="string"){element.value=valueStr}else{element.innerHTML=valueStr}}}function setContentsFromBody(idname,bodystr,multiple,onlyhtml){var mainbody=multiple?"":bodystr;if(multiple){var textArr=str2lineArray(bodystr);var hh=0;while(hh<textArr.length){var strlin=textArr[hh++];if(!strlin||strlin===":"){break}var idval=/([^:]*):(.*)/.exec(strlin);laData.setData(idval[1],idval[2])}mainbody=textArr.slice(hh).join("\n")}if(onlyhtml){var ele=document.getElementById(idname);if(ele){setValueToElement(ele,mainbody)}}else{laData.setData(idname,mainbody)}}};